# RIP
RIP: Radomized Image Path

---

# 修正履歴

* 20200302: スクリプトが最上位フォルダー (www)に位置している場合、URLが正しく取得できない問題を修正しました。立教大学の五十嵐彰先生からご指摘頂きました。ありがとうございます。

---

Qualtricsでランダムに画像を出す場合、2〜3枚の中から1枚を見せるならそれぞれの質問文を用意し、Randomizerを使うことで十分です。

しかし、画像が数十〜数千枚であり、この中から1枚、あるいは数枚をランダムに示したい場合があります。画像を使う実験ではよくありがちな話です。

以下のスクリプトを使うとスクリプトの中身を修正する必要なく、画像ファイルが保存されているフォルダーに入れておくだけで、簡単に出来ます。

画像のタイプ（png/jpgなど）や抽出する枚数を調整するためにスクリプトの中身を修正する必要はなく、スクリプトのアドレスの後ろにパラメーターを指定するだけで使えます。しかも、ファイル名が規則正しく指定されている必要もありません。

---

# 使い方

1. PHPスクリプトのダウンロード&アップロード

* スクリプトファイル（`RIP.php`）をダウンロードする。
* FTPクライアントなどでサーバーへアクセスし、イメージファイルが保存されているフォルダーにスクリプトファイルをアップロードする。
  * 画像ファイル名にスペースが含まれている場合、Qualtricsで読み込めませんので、予めスペースを消しておいてください。

2. 動作の確認

* 以下のアドレスでアクセスします。
  * アドレス名/RIP.php?Ext=拡張子&N=持ってくる画像数
  * もし、RIP.phpと画像ファイルが保存されている場所が`http://tintstyle.cafe24.com/Qualtrics/RIP_Script/`であり、画像ファイルの拡張子がpng、ランダムに持ってくる画像数が3枚なら`http://tintstyle.cafe24.com/Qualtrics/RIP_Script/RIP.php?Ext=png&N=3`のように入力します。
  * 上記のフォルダー内には4枚のpng画像、6枚のjpg画像が保存されています。ExtとNパラメーターを変えてみて、どんな感じなのかを確認するのも良いでしょう。
    * `{"Path1" : "blahblah", "Path2" : "hogehoge", …}`のように出力されたらOK

3. QualtricsのWeb Service登録

* Qualtircsの質問紙作成画面でSurvey Flowをクリック
* Add a New Element hereをクリック
* Web Serviceを選択し、先ほど動作を確認した際のURLを入力
  * たとえば、`http://tintstyle.cafe24.com/Qualtrics/RIP_Script/RIP.php?Ext=jpg&N=3`
* Test URLをクリック
* Selectの隣のAllを選択し、Add Embedded Dataをクリック 6 Web Serviceのブロックを実験の質問文が含まれているブロックの上へ移動(必ず!!!)

4. 質問文の作成

* 質問文の修正はHTMLで行います。
* 適切な場所に以下のようにタグを挿入します。
  * 例) `<img src = ${e://Field/Path1}>` (Path1は適宜修正してください。)
